Run swift test --filter KVHeavyTasksManagerTests
Fetching https://github.com/Alamofire/Alamofire.git
[1/30176] Fetching alamofire
Fetched https://github.com/Alamofire/Alamofire.git from cache (2.86s)
Computing version for https://github.com/Alamofire/Alamofire.git
Computed https://github.com/Alamofire/Alamofire.git at 5.10.2 (0.55s)
Creating working copy for https://github.com/Alamofire/Alamofire.git
Working copy of https://github.com/Alamofire/Alamofire.git resolved at 5.10.2
warning: 'monstra': found 1 file(s) which are unhandled; explicitly declare them as resources or exclude from the target
    /Users/runner/work/Monstra/Monstra/Sources/Monstore/MemoryCache/README.md
Building for debugging...
[0/18] /Users/runner/work/Monstra/Monstra/.build/arm64-apple-macosx/debug/MonstraPackageTests.derived/runner.swift
[1/18] Write sources
[8/18] Write KVHeavyTaskDataProviderExample-entitlement.plist
[8/18] Write sources
[11/18] Copying PrivacyInfo.xcprivacy
[12/18] Write swift-version--4CD4308975962E7A.txt
[14/53] Emitting module MonstraBase
[15/55] Emitting module Alamofire
[16/69] Compiling Alamofire Alamofire.swift
[17/69] Compiling Alamofire AFError.swift
[18/69] Compiling Alamofire DataRequest.swift
[19/69] Compiling Alamofire DataStreamRequest.swift
[20/69] Compiling MonstraBase RetryCount.swift
[21/69] Compiling MonstraBase TracingIDFactory.swift
[22/80] Compiling Monstore TTLPriorityLRUQueue.swift
[23/80] Emitting module Monstore
[24/80] Compiling MonstraBaseTests CPUTimeStampPerformanceTests.swift
[25/80] Compiling MonstraBaseTests CPUTimeStampTests.swift
[26/81] Compiling Monstore CacheStatistics.swift
[27/81] Compiling Alamofire SessionDelegate.swift
[28/81] Compiling Alamofire URLConvertible+URLRequestConvertible.swift
[29/81] Compiling Alamofire UploadRequest.swift
[30/81] Compiling Alamofire WebSocketRequest.swift
[31/81] Compiling Alamofire DispatchQueue+Alamofire.swift
[32/81] Compiling Alamofire OperationQueue+Alamofire.swift
[33/81] Compiling Alamofire Result+Alamofire.swift
[34/81] Compiling Alamofire StringEncoding+Alamofire.swift
[35/81] Compiling Alamofire URLRequest+Alamofire.swift
[36/81] Compiling Alamofire URLSessionConfiguration+Alamofire.swift
[37/81] Compiling Alamofire AlamofireExtended.swift
[38/81] Compiling Alamofire AuthenticationInterceptor.swift
[39/81] Compiling Alamofire CachedResponseHandler.swift
[40/81] Compiling Alamofire Combine.swift
[41/87] Compiling MonstoreTests MemoryCachePerformanceTests.swift
[42/87] Compiling MonstoreTests PriorityLRUQueuePerformanceTests.swift
[43/87] Compiling MonstoreTests MemoryCacheTests.swift
[44/87] Compiling MonstoreTests PriorityLRUQueueTests.swift
[45/87] Compiling MonstoreTests TTLPriorityLRUQueueTests.swift
[46/87] Compiling MonstraBaseTests HeapTests.swift
[47/87] Compiling Alamofire HTTPMethod.swift
[48/87] Compiling Alamofire Notifications.swift
[49/87] Compiling Alamofire ParameterEncoder.swift
[50/87] Compiling Alamofire ParameterEncoding.swift
[51/87] Compiling Alamofire Protected.swift
[52/87] Compiling Alamofire Request.swift
[53/87] Compiling Alamofire RequestTaskMap.swift
[54/87] Compiling Alamofire Response.swift
[55/87] Compiling Alamofire Session.swift
[56/87] Compiling Alamofire Concurrency.swift
[57/87] Compiling Alamofire EventMonitor.swift
[58/87] Compiling Alamofire MultipartFormData.swift
[59/87] Compiling Alamofire MultipartUpload.swift
[60/87] Compiling Alamofire NetworkReachabilityManager.swift
[61/87] Compiling Alamofire RedirectHandler.swift
[62/87] Compiling Alamofire RequestCompression.swift
[63/87] Compiling Alamofire RequestInterceptor.swift
[64/87] Compiling Alamofire ResponseSerialization.swift
[65/87] Compiling Alamofire RetryPolicy.swift
[66/87] Compiling Alamofire ServerTrustEvaluation.swift
[67/87] Compiling Alamofire URLEncodedFormEncoder.swift
[68/87] Compiling Alamofire Validation.swift
[69/87] Compiling Alamofire resource_bundle_accessor.swift
[70/90] Compiling Monstask KVHeavyTasksManager.swift
/Users/runner/work/Monstra/Monstra/Sources/Monstask/KVHeavyTasksManager.swift:987:45: warning: reference to captured var 'self' in concurrently-executing code; this is an error in the Swift 6 language mode
 985 |                 // Handle custom events (progress updates, status changes, etc.)
 986 |                 DispatchQueue.global().async {
 987 |                     guard let taskManager = self else { return }
     |                                             `- warning: reference to captured var 'self' in concurrently-executing code; this is an error in the Swift 6 language mode
 988 |                     taskManager.semaphore.wait()
 989 |                     defer { taskManager.semaphore.signal() }

/Users/runner/work/Monstra/Monstra/Sources/Monstask/KVHeavyTasksManager.swift:1001:45: warning: reference to captured var 'self' in concurrently-executing code; this is an error in the Swift 6 language mode
 999 |                 // Handle final task result (success or failure)
1000 |                 DispatchQueue.global().async {
1001 |                     guard let taskManager = self else { return }
     |                                             `- warning: reference to captured var 'self' in concurrently-executing code; this is an error in the Swift 6 language mode
1002 |                     taskManager.semaphore.wait()
1003 |                     defer { taskManager.semaphore.signal() }
[71/90] Emitting module Monstask
[72/90] Compiling Monstask KVLightTasksManager.swift
[73/91] Compiling Monstask MonoTask.swift
[74/96] Emitting module MonstoreTests
[75/98] Emitting module MonstraBaseTests
[76/100] Emitting module MonstaskTests
[77/101] Compiling MonstaskTests KVHeavyTasksManagerTests.swift
[78/101] Compiling MonstaskTests KVLightTasksManagerTests.swift
[79/101] Compiling MonstoreTests TTLPriorityLRUQueuePerformanceTests.swift
[80/101] Compiling MonstraBaseTests RetryCountTests.swift
[81/101] Compiling MonstaskTests MonoTaskCrossScenarioTests.swift
/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:921:14: warning: result of call to 'remove(at:)' is unused
 919 |         heap.insert(10)
 920 |         heap.insert(20)
 921 |         heap.remove()
     |              `- warning: result of call to 'remove(at:)' is unused
 922 |         
 923 |         // Should have recorded events

/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:945:22: warning: result of call to 'remove(at:)' is unused
 943 |             
 944 |             for _ in 0..<1000 {
 945 |                 heap.remove()
     |                      `- warning: result of call to 'remove(at:)' is unused
 946 |             }
 947 |         }
/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:921:14: warning: result of call to 'remove(at:)' is unused
 919 |         heap.insert(10)
 920 |         heap.insert(20)
 921 |         heap.remove()
     |              `- warning: result of call to 'remove(at:)' is unused
 922 |         
 923 |         // Should have recorded events

/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:945:22: warning: result of call to 'remove(at:)' is unused
 943 |             
 944 |             for _ in 0..<1000 {
 945 |                 heap.remove()
     |                      `- warning: result of call to 'remove(at:)' is unused
 946 |             }
 947 |         }
/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:921:14: warning: result of call to 'remove(at:)' is unused
 919 |         heap.insert(10)
 920 |         heap.insert(20)
 921 |         heap.remove()
     |              `- warning: result of call to 'remove(at:)' is unused
 922 |         
 923 |         // Should have recorded events

/Users/runner/work/Monstra/Monstra/Tests/MonstraBaseTests/HeapTests.swift:945:22: warning: result of call to 'remove(at:)' is unused
 943 |             
 944 |             for _ in 0..<1000 {
 945 |                 heap.remove()
     |                      `- warning: result of call to 'remove(at:)' is unused
 946 |             }
 947 |         }
[86/101] Compiling MonstaskTests MonoTaskClearResultTests.swift
[87/101] Compiling MonstaskTests MonoTaskTests.swift
[89/101] Compiling MonstraBaseTests TracingIDFactoryTest.swift
[93/103] Emitting module KVHeavyTaskDataProviderExample
[94/103] Compiling KVHeavyTaskDataProviderExample main.swift
/Users/runner/work/Monstra/Monstra/Examples/KVHeavyTaskDataProviderExample/main.swift:55:27: warning: immutable value 'value' was never used; consider replacing with '_' or removing it
 53 |         case .idle:
 54 |             resumeData = ""
 55 |         case .running(let value):
    |                           `- warning: immutable value 'value' was never used; consider replacing with '_' or removing it
 56 |             return
 57 |         case .finished(let value):

/Users/runner/work/Monstra/Monstra/Examples/KVHeavyTaskDataProviderExample/main.swift:57:28: warning: immutable value 'value' was never used; consider replacing with '_' or removing it
 55 |         case .running(let value):
 56 |             return
 57 |         case .finished(let value):
    |                            `- warning: immutable value 'value' was never used; consider replacing with '_' or removing it
 58 |             return
 59 |         case .paused(let value):

/Users/runner/work/Monstra/Monstra/Examples/KVHeavyTaskDataProviderExample/main.swift:371:9: warning: initialization of immutable value 'smallFileURL' was never used; consider replacing with assignment to '_' or removing it
369 | func alamofireDataProviderTest() {
370 |     let largeFileURL = "https://updatecdn.meeting.qq.com/cos/197eaf6e0ea4bcafff72e5bb623555e6/TencentMeeting_0300000000_3.35.1.437.publish.arm64.officialwebsite.dmg"
371 |     let smallFileURL = "https://www.google.com"
    |         `- warning: initialization of immutable value 'smallFileURL' was never used; consider replacing with assignment to '_' or removing it
372 |     
373 |     /// Currently selected test URL for demonstration
[94/103] Write Objects.LinkFileList
[95/103] Linking KVHeavyTaskDataProviderExample
[96/103] Applying KVHeavyTaskDataProviderExample
[102/105] Emitting module MonstraPackageTests
[103/105] Compiling MonstraPackageTests runner.swift
[103/105] Write Objects.LinkFileList
[104/105] Linking MonstraPackageTests
Build complete! (36.00s)
Test Suite 'Selected tests' started at 2025-08-22 00:09:11.697.
Test Suite 'MonstraPackageTests.xctest' started at 2025-08-22 00:09:11.698.
Test Suite 'KVHeavyTasksManagerTests' started at 2025-08-22 00:09:11.698.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testAggregatedCallbacks]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testAggregatedCallbacks]' passed (0.793 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testBasicFetchAndProgress]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testBasicFetchAndProgress]' passed (0.428 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheEdgeCases_NullAndInvalidKeys]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheEdgeCases_NullAndInvalidKeys]' passed (1.389 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheEdgeCases]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheEdgeCases]' passed (0.974 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheStatisticsReporting]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCacheStatisticsReporting]' passed (2.676 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCompareDeallocVsReuse]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCompareDeallocVsReuse]' passed (6.901 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentFetchAndFinish]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentFetchAndFinish]' passed (3.326 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentFetchSameKeyDifferentStates]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentFetchSameKeyDifferentStates]' passed (3.830 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentMultipleFetchSameKey]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentMultipleFetchSameKey]' passed (1.916 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentMultipleStops]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentMultipleStops]' passed (3.953 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentStopThenImmediateFetch]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentStopThenImmediateFetch]' passed (2.625 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentTasks]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentTasks]' passed (1.377 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentTripleRace]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConcurrentTripleRace]' passed (8.313 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConfigurationEdgeCases]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testConfigurationEdgeCases]' passed (0.707 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_ErrorHandling_Resume_Events]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_ErrorHandling_Resume_Events]' passed (3.469 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_FIFO_Eviction_Resume_Events]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_FIFO_Eviction_Resume_Events]' passed (2.062 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_LIFOAwait_Cache_MultipleCallbacks]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_LIFOAwait_Cache_MultipleCallbacks]' passed (1.661 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_QueueCapacity_Priority_EventOrdering]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_QueueCapacity_Priority_EventOrdering]' passed (3.742 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_StressCombined]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCrossScenario_StressCombined]' passed (3.720 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCustomEventHandling]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testCustomEventHandling]' passed (1.179 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataCacheBehavior]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataCacheBehavior]' passed (0.936 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderErrorHandling]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderErrorHandling]' passed (1.427 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderErrorScenarios]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderErrorScenarios]' passed (1.470 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderReturnsNilOnStop]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderReturnsNilOnStop]' passed (2.857 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderReturnsResumeDataOnStop]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderReturnsResumeDataOnStop]' passed (2.936 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderValidationConsistency]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testDataProviderValidationConsistency]' passed (12.307 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testExtremeStressConcurrencySameKeyRandomly]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testExtremeStressConcurrencySameKeyRandomly]' passed (5.368 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testExtremeStressConcurrencySameKey]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testExtremeStressConcurrencySameKey]' passed (5.663 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksEqualRunningSlots]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksEqualRunningSlots]' passed (0.829 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksEqualTotalCapacity]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksEqualTotalCapacity]' passed (1.363 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksExceedRunningWithinCapacity]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksExceedRunningWithinCapacity]' passed (1.210 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksExceedTotalCapacity]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksExceedTotalCapacity]' passed (2.122 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksLessThanRunningSlots]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testFIFO_TasksLessThanRunningSlots]' passed (0.851 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testLIFOAwaitStrategy]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testLIFOAwaitStrategy]' passed (1.686 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testLIFOStopStrategy]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testLIFOStopStrategy]' passed (2.684 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testMultipleInterruptions_DeallocVsReuse]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testMultipleInterruptions_DeallocVsReuse]' passed (9.391 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testMultipleLIFOStopOperations]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testMultipleLIFOStopOperations]' passed (2.625 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testProviderCleanupVerification]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testProviderCleanupVerification]' passed (25.186 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testRapidFetchOperations]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testRapidFetchOperations]' passed (2.975 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testRapidFetchStopCycle]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testRapidFetchStopCycle]' passed (51.302 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResultCallbackExecutedOncePerFetch]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResultCallbackExecutedOncePerFetch]' passed (0.728 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResumeDataConsistency]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResumeDataConsistency]' passed (2.939 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResumeFromPartialProgress]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testResumeFromPartialProgress]' passed (6.855 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testStopAction_DeallocBehavior]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testStopAction_DeallocBehavior]' passed (2.387 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testStopAction_ReuseBehavior]' started.
/Users/runner/work/Monstra/Monstra/Tests/MonstaskTests/KVHeavyTasksManagerTests.swift:2063: error: -[MonstaskTests.KVHeavyTasksManagerTests testStopAction_ReuseBehavior] : XCTAssertTrue failed - Should detect resume from last progress (reuse behavior)
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testStopAction_ReuseBehavior]' failed (1.949 seconds).
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testTaskWithAwaitStrategy]' started.
Test Case '-[MonstaskTests.KVHeavyTasksManagerTests testTaskWithAwaitStrategy]' passed (1.429 seconds).
Test Suite 'KVHeavyTasksManagerTests' failed at 2025-08-22 00:12:38.219.
	 Executed 46 tests, with 1 failure (0 unexpected) in 206.516 (206.521) seconds
Test Suite 'MonstraPackageTests.xctest' failed at 2025-08-22 00:12:38.246.
	 Executed 46 tests, with 1 failure (0 unexpected) in 206.516 (206.548) seconds
Test Suite 'Selected tests' failed at 2025-08-22 00:12:38.246.
	 Executed 46 tests, with 1 failure (0 unexpected) in 206.516 (206.549) seconds
◇ Test run started.
↳ Testing Library Version: 94 (arm64e-apple-macos13.0)
✔ Test run with 0 tests passed after 0.001 seconds.
Error: Process completed with exit code 1.